<!doctype html><html><head><title>Day 4: Passport Processing</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/assets/css/bootstrap.min.css><link rel=stylesheet href=/assets/css/layouts/main.css><link rel=stylesheet href=/assets/css/style.css><link rel=stylesheet href=/assets/css/navigators/navbar.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/assets/images/favicon.png><link rel=stylesheet href=/assets/css/style.css><meta name=description content="Day 4 of AoC 2020"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/assets/css/layouts/single.css><link rel=stylesheet href=/assets/css/navigators/sidebar.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/assets/images/main-logo.png>Kristof Achten | Portfolio & Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/assets/images/main-logo.png class=d-none id=main-logo>
<img src=/assets/images/inverted-logo.png class=d-none id=inverted-logo></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><input type=text placeholder=Search data-search id=search-box><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href>Advent of Code 2020</a><ul class=active><li><a href=/posts/advent-of-code-2020/day1/>Day 1</a></li><li><a href=/posts/advent-of-code-2020/day2/>Day 2</a></li><li><a href=/posts/advent-of-code-2020/day3/>Day 3</a></li><li><a class=active href=/posts/advent-of-code-2020/day4/>Day 4</a></li><li><a href=/posts/advent-of-code-2020/day5/>Day 5</a></li><li><a href=/posts/advent-of-code-2020/day6/>Day 6</a></li><li><a href=/posts/advent-of-code-2020/day7/>Day 7</a></li><li><a href=/posts/advent-of-code-2020/day8/>Day 8</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://kristofachten.github.io/posts/Advent%20of%20Code%202020/aoc.jpeg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/me.png><h5 class=author-name>Kristof Achten</h5><p>December 4, 2020</p></div><div class=title><h1>Day 4: Passport Processing</h1></div><div class=post-content id=post-content><h2 id=intro>Intro</h2><p>Aah yes, <a href=https://papersplea.se/>papers please!</a> Today, we&rsquo;re determining which passports get stamped and which do not! Our input is, to no surprise, a list of passports of which each passport is defined as follows:</p><pre><code>iyr:2019
hcl:#602927 eyr:1967 hgt:170cm
ecl:brn pid:012533040 byr:1946
</code></pre><p>They are simple <code>key:value</code> pairs, seperated over multiple lines.</p><h2 id=solution>Solution</h2><p>As usual, we start by seperating our raw input into usable chunks. This time, each passport (because it can contain multiple lines) is separated by an empty line. We therefor split on the <code>\n\n</code> delimiter.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>val</span> input = rawInput.split(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#34;</span>)
</code></pre></div><p>Now having each separate passport, we can extract the <code>key:value</code> pairs, and ideally stow them away in a map for easy access later. Extracting the pairs is easy: we first put everything on the same line by calling <code>String.replace('\n', ' ')</code> on the passport, then splitting on spaces <code>String.split(' ')</code>, and finally splitting on the colon character <code>String.split(':')</code>. We collect this as a map per passport, and then collect all these maps as a list which we dump in a global variable.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>var</span> kvSets: List&lt;Map&lt;String, String&gt;&gt; <span style=color:#66d9ef>by</span> Delegates.notNull()

<span style=color:#66d9ef>init</span> {
	<span style=color:#66d9ef>this</span>.kvSets = input.map {
		<span style=color:#66d9ef>it</span>.replace(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34; &#34;</span>)
				.split(<span style=color:#e6db74>&#34; &#34;</span>)
				.map() { Pair(<span style=color:#66d9ef>it</span>.split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>0</span>], <span style=color:#66d9ef>it</span>.split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>1</span>]) }
				.toMap()
	}.toList()
}
</code></pre></div><h3 id=part-1>Part 1</h3><p>For part one, we have to determine which passports are valid. A passport is valid if it at least contains the mandatory fields (see code below). Checking this is easy given the list of maps we&rsquo;ve just created: simply loop over each map in the list and map this map (hah..) to a boolean value by checking if there is any required field that&rsquo;s not in that map (which would yield true, and false if all of them are in the given map). In the end, we filter out all of the true-values and count the size of the remaining list. This is our answer.</p><pre><code>val reqFields = listOf&lt;String&gt;(&quot;byr&quot;, &quot;iyr&quot;, &quot;eyr&quot;, &quot;hgt&quot;, &quot;hcl&quot;, &quot;ecl&quot;, &quot;pid&quot;)

override fun part1() = countValidPassports().toString()

private fun countValidPassports(): Int {
	return kvSets.map { kvSet -&gt; 
		reqFields.any { !kvSet.containsKey(it)}
	}.filterNot { it }.count()
}
</code></pre><h3 id=part-2>Part 2</h3><p>Part two is, again, trickier. Per key, we now have a rule that tells us whether or not its value is valid. Given these rules, determine all passports that are valid.</p><p>I decided it would be nice to define a separate decision function for each rule that determines whether the input value is valid. We can then simply transform <code>reqFields</code> into a map of type <code>Map&lt;String, (String) -> Boolean></code>. The key is&mldr; well, the key (like <code>'iyr'</code>, <code>'hcl'</code>, &mldr;), and the value is the decision function. I will define the decision function for each key in the paragraphs below.</p><h4 id=decision-function-for-byr-iyr-and-eyr>Decision function for &lsquo;byr&rsquo;, &lsquo;iyr&rsquo; and &lsquo;eyr&rsquo;</h4><p>These are straightforward checks to see if their value lies between two constants.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>val</span> validByr: (String) <span style=color:#f92672>-&gt;</span> Boolean = { <span style=color:#66d9ef>data</span> <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>data</span>.toInt() <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1920</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>data</span>.toInt() <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>2002</span> }
<span style=color:#66d9ef>val</span> validIyr: (String) <span style=color:#f92672>-&gt;</span> Boolean = { <span style=color:#66d9ef>data</span> <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>data</span>.toInt() <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>2010</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>data</span>.toInt() <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>2020</span> }
<span style=color:#66d9ef>val</span> validEyr: (String) <span style=color:#f92672>-&gt;</span> Boolean = { <span style=color:#66d9ef>data</span> <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>data</span>.toInt() <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>2020</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>data</span>.toInt() <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>2030</span> }
</code></pre></div><h4 id=decision-function-for-hcl>Decision function for &lsquo;hcl&rsquo;</h4><p>Here, we check whether the value starts with <code>#</code>, and contains exactly six characters in the alphabet [a-f0-9]. This smells like regular expressions could be useful, and you&rsquo;re right!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>val</span> validHcl: (String) <span style=color:#f92672>-&gt;</span> Boolean = { <span style=color:#66d9ef>data</span> <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>data</span>[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;#&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#e6db74>&#34;^([a-f0-9]{6})*$&#34;</span>.toRegex().matches(<span style=color:#66d9ef>data</span>.substring(<span style=color:#ae81ff>1</span>)) }
</code></pre></div><h4 id=decision-function-for-ecl>Decision function for &lsquo;ecl&rsquo;</h4><p>Again, fairly simple: just checking if the value is part of a predefined list of values.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>val</span> validEcl: (String) <span style=color:#f92672>-&gt;</span> Boolean = { <span style=color:#66d9ef>data</span> <span style=color:#f92672>-&gt;</span> listOf&lt;String&gt;(<span style=color:#e6db74>&#34;amb&#34;</span>, <span style=color:#e6db74>&#34;blu&#34;</span>, <span style=color:#e6db74>&#34;brn&#34;</span>, <span style=color:#e6db74>&#34;gry&#34;</span>, <span style=color:#e6db74>&#34;grn&#34;</span>, <span style=color:#e6db74>&#34;hzl&#34;</span>, <span style=color:#e6db74>&#34;oth&#34;</span>).contains(<span style=color:#66d9ef>data</span>) }
</code></pre></div><h4 id=decision-function-for-pid>Decision function for &lsquo;pid&rsquo;</h4><p>You&rsquo;ll need to check that the value consists of exactly 9 numbers. I cheated a little bit, and just checked that the length was 9. This worked out fine for me, but know that you can use another regex to make sure they&rsquo;re all numbers as well.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>val</span> validPid: (String) <span style=color:#f92672>-&gt;</span> Boolean = { <span style=color:#66d9ef>data</span> <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>data</span>.length <span style=color:#f92672>==</span> <span style=color:#ae81ff>9</span> }
</code></pre></div><h4 id=decision-function-for-hgt>Decision function for &lsquo;hgt&rsquo;</h4><p>This is the one that requires the most code, but it&rsquo;s not necessarily more difficult. We simply determine (given that the value is longer than 2 characters long) the unit (&lsquo;in&rsquo; or &lsquo;cm&rsquo;), and perform extra checks based on the rules per unit.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>val</span> validHgt: (String) <span style=color:#f92672>-&gt;</span> Boolean = { <span style=color:#66d9ef>data</span> <span style=color:#f92672>-&gt;</span>
	<span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>data</span>.length &gt; <span style=color:#ae81ff>2</span>) {
		<span style=color:#66d9ef>val</span> value = <span style=color:#66d9ef>data</span>.substring(<span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>data</span>.length - <span style=color:#ae81ff>2</span>).toInt()
		<span style=color:#66d9ef>val</span> unit = <span style=color:#66d9ef>data</span>.substring(<span style=color:#66d9ef>data</span>.length - <span style=color:#ae81ff>2</span>)

		<span style=color:#66d9ef>if</span> (unit <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;cm&#34;</span>) value <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>150</span> <span style=color:#f92672>&amp;&amp;</span> value <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>193</span>
		<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (unit <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;in&#34;</span>) value <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>59</span> <span style=color:#f92672>&amp;&amp;</span> value <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>76</span>
		<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>false</span>
	} <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>false</span>
}
</code></pre></div><h4 id=final-setup>Final setup</h4><p>Having all of these decision functions, we can expand <code>reqFields</code>;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>val</span> reqFields = mapOf&lt;String, (String) <span style=color:#f92672>-&gt;</span> Boolean&gt;(
		Pair(<span style=color:#e6db74>&#34;byr&#34;</span>, validByr),
		Pair(<span style=color:#e6db74>&#34;iyr&#34;</span>, validIyr),
		Pair(<span style=color:#e6db74>&#34;eyr&#34;</span>, validEyr),
		Pair(<span style=color:#e6db74>&#34;hgt&#34;</span>, validHgt),
		Pair(<span style=color:#e6db74>&#34;hcl&#34;</span>, validHcl),
		Pair(<span style=color:#e6db74>&#34;ecl&#34;</span>, validEcl),
		Pair(<span style=color:#e6db74>&#34;pid&#34;</span>, validPid)
)
</code></pre></div><p>We now update the <code>countValidPassports()</code> method to account for these decision functions. To make sure that this function still works with part one, we add the <code>checkRestrictions</code> input parameter that determines whether or not the decision functions will be checked.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>part1</span>() = countValidPassports(<span style=color:#66d9ef>false</span>).toString() <span style=color:#75715e>// updated
</span><span style=color:#75715e></span><span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>part2</span>() = <span style=color:#66d9ef>return</span> countValidPassports(<span style=color:#66d9ef>true</span>).toString()

<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>countValidPassports</span>(checkRestrictions: Boolean): Int {
	<span style=color:#66d9ef>return</span> kvSets.map { kvSet <span style=color:#f92672>-&gt;</span>
		reqFields.any { <span style=color:#66d9ef>field</span> <span style=color:#f92672>-&gt;</span>
			!kvSet.containsKey(<span style=color:#66d9ef>field</span>.key) <span style=color:#f92672>||</span> (checkRestrictions <span style=color:#f92672>&amp;&amp;</span> !<span style=color:#66d9ef>field</span>.value(kvSet.getValue(<span style=color:#66d9ef>field</span>.key)))
		}
	}.filterNot { <span style=color:#66d9ef>it</span> }.count()
}
</code></pre></div></div><div class=btn-improve-page><a href=https://github.com/hugo-toha/hugo-toha.github.io/edit/master/content/posts/Advent%20of%20Code%202020/day4.md><i class="fas fa-code-branch"></i>Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/advent-of-code-2020/day5/ class="btn btn-outline-info"><span><i class="fas fa-chevron-circle-left"></i>Prev</span><br><span>Day 5: Binary Boarding</span></a></div><div class="col-md-6 next-article"><a href=/posts/advent-of-code-2020/day3/ class="btn btn-outline-info"><span>Next <i class="fas fa-chevron-circle-right"></i></span><br><span>Day 3: Toboggan Trajectory</span></a></div></div><hr></div></div></div></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#solution>Solution</a><ul><li><a href=#part-1>Part 1</a></li><li><a href=#part-2>Part 2</a><ul><li><a href=#decision-function-for-byr-iyr-and-eyr>Decision function for &lsquo;byr&rsquo;, &lsquo;iyr&rsquo; and &lsquo;eyr&rsquo;</a></li><li><a href=#decision-function-for-hcl>Decision function for &lsquo;hcl&rsquo;</a></li><li><a href=#decision-function-for-ecl>Decision function for &lsquo;ecl&rsquo;</a></li><li><a href=#decision-function-for-pid>Decision function for &lsquo;pid&rsquo;</a></li><li><a href=#decision-function-for-hgt>Decision function for &lsquo;hgt&rsquo;</a></li><li><a href=#final-setup>Final setup</a></li></ul></li></ul></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=#about>About</a></li><li class=nav-item><a class=smooth-scroll href=#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=#achievements>Achievements</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>kristofachten@gmail.com</span></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=#><img src=/assets/images/inverted-logo.png>
Toha</a></div><div class="col-md-4 text-center">divyak © 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/>Powered by
<img src=/assets/images/hugo-logo-wide.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/assets/js/jquery-3.4.1.min.js></script><script src=/assets/js/popper.min.js></script><script src=/assets/js/bootstrap.min.js></script><script src=/assets/js/navbar.js></script><script src=/assets/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/assets/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>